import{k as u,j as O,u as B,h as P,c as U,E as I,O as h,s as E,n as D,m as y,G as L,_ as Y,a as C,b as p,w as A,r as f,o as g,d as n,v as R,e as N}from"../index98407.js";import{s as k,h as _}from"./loader98407.js";const j={setup(){const w=u({icon:"pi pi-home",to:"/aziende"}),l=u(""),v=u([{label:""}]),a=O(),o=B(),c=P(),t=u({}),i=u({}),r=u(!1),m=U(()=>o.getters[L.CURRENT_COMPANY]),x=async function(){try{return await o.dispatch(h.FETCH_ALL_COMPANIES)}catch(e){_(o),y(c,e)}},d=async function(){try{const e=await o.dispatch(h.FETCH_COMPANY_DETAIL,a.params.id+"");return S(),e}catch(e){_(o),y(c,e)}},T=function(){const e=new FormData;return i.value&&i.value.name&&e.append("company[logo]",i.value),e.append("company[name]",t.value.name+""),e},F=async function(){if(b())return;k(o);const e={company_id:t.value.id,formData:T()};try{const s=await o.dispatch(h.UPDATE_COMPANY,e);return E(c,{message:"Azienda aggiornata correttamente.",title:""}),_(o),D.replace({name:"aziende"}),s}catch(s){_(o),y(c,s)}},V=async function(){if(b())return;k(o);const e={formData:T()};try{const s=await o.dispatch(h.CREATE_COMPANY,e);return E(c,{message:"Azienda creata correttamente.",title:""}),_(o),D.replace({name:"aziende"}),s}catch(s){_(o),y(c,s)}},S=function(){t.value.id=m.value.id,t.value.name=m.value.name,t.value.logo_url=m.value.logo_url},z=function(){l.value!=""&&t.value.id?F():V()},b=function(){var e,s;return((e=t.value)==null?void 0:e.name)==""||((s=t.value)==null?void 0:s.name)==null?r.value=!0:r.value=!1,r.value},M=e=>{t.value.logo_url="",i.value=e.files[0]};return I(async()=>{x(),l.value=a.params.id+"",l.value!=""?(d(),v.value[0]={label:"Modifica azienda"}):v.value[0]={label:"Nuova azienda"}}),{company_detail:m,home:w,items:v,tmp_company:t,invalid_name:r,uploadedFile:i,saveCompany:z,validateName:b,onSelectedFiles:M}},components:{}};const G={class:"m-4"},H={class:"flex align-items-center justify-content-between"},q=n("h1",null,"AZIENDA",-1),Z={class:"flex justify-content-end"},J={class:"formgrid grid col-10 flex-column"},K={class:"field col-6"},Q=n("label",{for:"name"},"Nome*",-1),W={key:0,id:"name",class:"p-error"},X={class:"col-6 mt-4 flex-column"},$=n("label",{for:"logo"},"Logo",-1),ee={key:0,class:"flex align-items-top"},ae=["src"],oe={key:0,class:"text-center"},te=n("b",null,"Trascina qui l'immagine",-1),ne=n("p",{class:"text-xs"},"(Dimensione massima 2 MB)",-1),le=[te,ne];function se(w,l,v,a,o,c){const t=f("Breadcrumb"),i=f("Button"),r=f("InputText"),m=f("FileUpload"),x=f("Card");return g(),C("div",G,[p(t,{home:a.home,model:a.items,class:"mb-3 mt-0 pt-0"},null,8,["home","model"]),p(x,null,{content:A(()=>[n("div",H,[q,n("div",Z,[p(i,{label:"Salva",onClick:a.saveCompany},null,8,["onClick"])])]),n("div",J,[n("div",K,[Q,p(r,{id:"name",type:"text",modelValue:a.tmp_company.name,"onUpdate:modelValue":l[0]||(l[0]=d=>a.tmp_company.name=d),class:R(["w-full",{"p-invalid":a.invalid_name}]),onChange:a.validateName},null,8,["modelValue","class","onChange"]),a.invalid_name?(g(),C("small",W,"Campo obbligatorio.")):N("",!0)]),n("div",X,[$,p(m,{name:"file",url:"https://www.primefaces.org/upload.php",multiple:!1,accept:"image/*",maxFileSize:2e6,id:"logo",modelValue:a.tmp_company.logo_url,"onUpdate:modelValue":l[2]||(l[2]=d=>a.tmp_company.logo_url=d),customUpload:!0,onSelect:a.onSelectedFiles},{content:A(()=>[a.tmp_company.logo_url?(g(),C("div",ee,[n("img",{role:"presentation",class:"p-fileupload-file-thumbnail",src:a.tmp_company.logo_url},null,8,ae),n("i",{class:"pi pi-times p-button-icon text-red-600 cursor-pointer font-semibold icon-delete",onClick:l[1]||(l[1]=d=>a.tmp_company.logo_url=null)})])):N("",!0)]),empty:A(()=>[a.tmp_company.logo_url?N("",!0):(g(),C("div",oe,le))]),_:1},8,["modelValue","onSelect"])])])]),_:1})])}const re=Y(j,[["render",se]]);export{re as default};
