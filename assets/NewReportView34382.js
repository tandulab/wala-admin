import{k as l,j as y,u as V,h as O,c as k,z as B,R as T,s as P,n as I,m as g,V as A,_ as D,a as E,b as i,w as L,r as m,o as b,d,v as S,e as U}from"../index34382.js";import{C as j}from"./CampaignsTable34382.js";import{s as z,h as f}from"./loader34382.js";import"./moment34382.js";const F={setup(){const R=l({icon:"pi pi-home",to:"/reports"}),c=l(""),u=l([{label:"Nuovo report"}]),e=y(),n=V(),p=O(),s=l(!1),t=l({}),r=l(),v=k(()=>n.getters[A.CURRENT_REPORT]),h=async function(){try{return await n.dispatch(T.FETCH_REPORT_DETAIL,e.params.id+"")}catch(a){f(n),g(p,a)}},_=function(){var a,o;return((a=t.value)==null?void 0:a.name)==""||((o=t.value)==null?void 0:o.name)==null?s.value=!0:s.value=!1,s.value},w=function(){var o;const a=(o=r==null?void 0:r.value)==null?void 0:o.selectedCampaigns;t.value.campaign_ids=[],a.forEach(N=>{var C;(C=t.value.campaign_ids)==null||C.push(N.id+"")}),x()},x=async function(){if(_())return;z(n);const a={report:{title:t.value.name,campaign_ids:t.value.campaign_ids}};try{const o=await n.dispatch(T.CREATE_REPORT,a);return P(p,{message:"Il Report verr\xE0 generato entro 10 minuti.",title:""}),I.push("/reports"),f(n),o}catch(o){f(n),g(p,o)}};return B(async()=>{c.value=e.params.id+"",c.value!=""&&(h(),u.value[0]={label:"Dettaglio template"})}),{template_detail:v,home:R,items:u,invalid_name:s,tmp_report:t,validateName:_,childComponent:r,newReport:w}},components:{CampaignsTable:j}};const G={class:"m-4"},H={class:"flex justify-content-between align-item-center"},q=d("h1",null,"NUOVO REPORT",-1),J={class:"field col-4 px-0"},K=d("label",{for:"name"},"Nome report*",-1),M={key:0,id:"name",class:"p-error"};function Q(R,c,u,e,n,p){const s=m("Breadcrumb"),t=m("Button"),r=m("InputText"),v=m("CampaignsTable"),h=m("Card");return b(),E("div",G,[i(s,{home:e.home,model:e.items,class:"mb-3 mt-0 pt-0"},null,8,["home","model"]),i(h,null,{content:L(()=>[d("div",H,[q,i(t,{label:"Crea Report",onClick:e.newReport},null,8,["onClick"])]),d("div",J,[K,i(r,{id:"name",type:"text",modelValue:e.tmp_report.name,"onUpdate:modelValue":c[0]||(c[0]=_=>e.tmp_report.name=_),class:S(["w-full",{"p-invalid":e.invalid_name}]),onChange:e.validateName},null,8,["modelValue","class","onChange"]),e.invalid_name?(b(),E("small",M,"Campo obbligatorio.")):U("",!0)]),i(v,{ref:"childComponent"},null,512)]),_:1})])}const $=D(F,[["render",Q]]);export{$ as default};
