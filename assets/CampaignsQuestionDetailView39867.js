import{k as r,p as B,j as O,u as Q,h as P,c as j,G as M,N as W,s as q,m as D,P as z,Q as F,_ as G,a as g,b as s,d as o,w as v,r as m,o as w,x as K,t as S,q as N,y as U,e as A,E as H,O as J,z as X}from"../index39867.js";import{s as k,h as x}from"./loader39867.js";const Y={setup(){const R=r({icon:"pi pi-home",to:"/campagne"}),n=r(""),C=r([{label:"Dettagio campagna",to:B.options.history.state.back+""},{label:"Modifica domanda"}]),t=O(),d=Q(),f=P(),l=r({}),E=r([]),u=r(!1),_=r({}),h=j(()=>d.getters[F.CURRENT_QUESTIONS]),b=async function(){if(p())return;k(d);const e={label_id:l.value.label_id,question_label:{label_it:l.value.label_it,title_it:l.value.title_it,tooltip_it:l.value.tooltip_it}};try{const i=await d.dispatch(W.UPDATE_QUESTION_LABEL,e);return q(f,{message:"Domanda aggiornata correttamente.",title:""}),x(d),i}catch(i){x(d),D(f,i)}},y=function(){l.value.label_it=_.value.labels.label_it,l.value.title_it=_.value.labels.title_it,l.value.tooltip_it=_.value.labels.tooltip_it,l.value.label_id=_.value.labels.id,l.value.answers=new Array,_.value.answers&&_.value.answers.forEach(e=>{var i;(i=l.value.answers)==null||i.push(e.labels)})},p=function(){var e,i;return((e=l.value)==null?void 0:e.label_it)==""||((i=l.value)==null?void 0:i.label_it)==null?u.value=!0:u.value=!1,u.value},a=async function(e){var V;if(p())return;k(d);const i={answer_id:e.id,answer_label:{label_it:e.label_it,tooltip_it:e.tooltip_it}};try{const T=await d.dispatch(z.UPDATE_ANSWER_LABEL,i);return q(f,{message:"Risposta aggiornata correttamente.",title:""}),(V=l.value.answers)==null||V.forEach((I,L)=>{I.id==e.id&&l.value.answers&&(l.value.answers[L]=e)}),x(d),T}catch(T){x(d),D(f,T)}},c=e=>{let{newData:i,index:V}=e;a(i)};return M(async()=>{n.value=t.params.id+"",n.value!=""&&h.value.forEach(e=>{e.id==n.value&&(_.value=e,y())})}),{question_detail:_,home:R,items:C,tmp_question:l,invalid_label_it:u,editingRows:E,updateQuestion:b,validateLabel:p,onRowEditSave:c}},components:{}};const Z={class:"m-4"},$={class:"flex flex-wrap"},tt={class:"col-6 flex-1"},et=o("div",{class:"flex align-items-center justify-content-between"},[o("h1",null,"DOMANDA")],-1),ot={class:"formgrid grid col-12 flex flex-column"},lt={class:"field"},at=o("label",{for:"note"},"Domanda",-1),st={class:"field flex flex-column"},it=o("label",{for:"note"},"Titolo",-1),nt={class:"field flex flex-column"},ct=o("label",{for:"note"},"Suggerimento",-1),dt={class:"flex justify-content-end"},_t={class:"col-6 flex-1"},ut={class:"flex flex-column preview"},rt=o("h1",null,"PREVIEW",-1),mt={class:"mb-0"},pt={class:"mt-2"},vt={key:0,class:"pi pi-info-circle"},ft={key:0,class:"pi pi-info-circle"},ht={class:"col-12"},bt=o("div",{class:"flex align-items-center justify-content-between"},[o("h1",null,"RISPOSTE")],-1),gt={class:"formgrid grid col-12 flex flex-column"};function wt(R,n,C,t,d,f){const l=m("Breadcrumb"),E=m("Textarea"),u=m("InputText"),_=m("Button"),h=m("Card"),b=m("Column"),y=m("DataTable"),p=X("tooltip");return w(),g("div",Z,[s(l,{home:t.home,model:t.items,class:"mb-3 mt-0 pt-0"},null,8,["home","model"]),o("div",$,[o("div",tt,[s(h,{class:"h-full"},{content:v(()=>[et,o("div",ot,[o("div",lt,[at,s(E,{id:"note",modelValue:t.tmp_question.label_it,"onUpdate:modelValue":n[0]||(n[0]=a=>t.tmp_question.label_it=a),rows:"5",cols:"30",class:K(["w-full",{"p-invalid":t.invalid_label_it}]),onChange:t.validateLabel},null,8,["modelValue","class","onChange"])]),o("div",st,[it,s(u,{type:"text",modelValue:t.tmp_question.title_it,"onUpdate:modelValue":n[1]||(n[1]=a=>t.tmp_question.title_it=a),class:"p-column-filter"},null,8,["modelValue"])]),o("div",nt,[ct,s(u,{type:"text",modelValue:t.tmp_question.tooltip_it,"onUpdate:modelValue":n[2]||(n[2]=a=>t.tmp_question.tooltip_it=a),class:"p-column-filter"},null,8,["modelValue"])])]),o("div",dt,[s(_,{label:"Salva",onClick:t.updateQuestion},null,8,["onClick"])])]),_:1})]),o("div",_t,[s(h,{class:"h-full"},{content:v(()=>{var a;return[o("div",ut,[rt,o("h3",mt,S(t.tmp_question.title_it),1),o("h4",pt,[N(S(t.tmp_question.label_it)+" ",1),(a=t.tmp_question)!=null&&a.tooltip_it?U((w(),g("i",vt,null,512)),[[p,t.tmp_question.tooltip_it,void 0,{top:!0}]]):A("",!0)]),(w(!0),g(H,null,J(t.tmp_question.answers,c=>(w(),g("p",{key:c.id,class:"mb-0"},[N(S(c.label_it)+" ",1),c.tooltip_it?U((w(),g("i",ft,null,512)),[[p,c.tooltip_it,void 0,{top:!0}]]):A("",!0)]))),128))])]}),_:1})])]),o("div",ht,[s(h,null,{content:v(()=>[bt,o("div",gt,[s(y,{value:t.tmp_question.answers,responsiveLayout:"scroll",editMode:"row",dataKey:"id",editingRows:t.editingRows,"onUpdate:editingRows":n[3]||(n[3]=a=>t.editingRows=a),onRowEditSave:t.onRowEditSave},{default:v(()=>[s(b,{field:"label_it",header:"Risposte"},{editor:v(({data:a,field:c})=>[s(u,{modelValue:a[c],"onUpdate:modelValue":e=>a[c]=e,autofocus:"",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),s(b,{field:"tooltip_it",header:"Suggerimento"},{editor:v(({data:a,field:c})=>[s(u,{modelValue:a[c],"onUpdate:modelValue":e=>a[c]=e,class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),s(b,{rowEditor:!0,style:{width:"10%","min-width":"8rem"},bodyStyle:"text-align:center"})]),_:1},8,["value","editingRows","onRowEditSave"])])]),_:1})])])}const yt=G(Y,[["render",wt]]);export{yt as default};
